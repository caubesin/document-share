{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport sendReq from '../helper/sendReqToServer';\nimport fileDownload from \"js-file-download\";\nexport const upLoadFile = createAsyncThunk(\"localhost:4000/upload\", async (data, thunkAPI) => {\n  const configReq = {\n    method: 'post',\n    url: '/upload',\n    header: {},\n    data: data\n  };\n  const res = await sendReq(configReq);\n  return res.data;\n});\nexport const downLoadFile = createAsyncThunk(\"localhost:4000/download\", async (file, thunkAPI) => {\n  const configReq = {\n    method: \"get\",\n    url: `/file/download/${file._id}`,\n    responseType: 'blob'\n  };\n  await sendReq(configReq).then(async res => {\n    const url = window.URL.createObjectURL(new Blob([res.data]));\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', 'file.pdf'); //or any other extension\n\n    document.body.appendChild(link);\n    link.click();\n    console.log(res); //await fileDownload(res.data, file.metadata.originalname);\n  }); //return await fileDownload(res.data, file.metadata.originalname);\n});\nexport const getFile = createAsyncThunk(\"localhost:4000/file\", async (type, thunkAPI) => {\n  const configReq = {\n    method: \"get\",\n    url: '/file',\n    params: {\n      type: type\n    }\n  };\n  const res = await sendReq(configReq);\n  return res.data;\n});\nconst file = createSlice({\n  name: \"file\",\n  initialState: {\n    file: [\"\"],\n    fileDownload: \"\",\n    message: {\n      type: null,\n      mess: null\n    },\n    isLoading: true\n  },\n  reducers: {\n    setMessage: (state, action) => {\n      state.message = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(upLoadFile.pending, (state, action) => {\n      state.isLoading = true;\n    });\n    builder.addCase(upLoadFile.fulfilled, (state, action) => {\n      state.message = action.payload.message;\n      state.isLoading = false;\n    });\n    builder.addCase(downLoadFile.fulfilled, (state, action) => {\n      state.fileDownload = action.payload;\n    });\n    builder.addCase(getFile.pending, (state, action) => {\n      state.isLoading = true;\n    });\n    builder.addCase(getFile.fulfilled, (state, action) => {\n      state.file = action.payload.file;\n      state.isLoading = false;\n    });\n  }\n});\nexport const {\n  setMessage\n} = file.actions;\nexport default file.reducer;","map":{"version":3,"sources":["D:/Learn_ReactJS/document-share/client/src/features/fileSlice.js"],"names":["createAsyncThunk","createSlice","sendReq","fileDownload","upLoadFile","data","thunkAPI","configReq","method","url","header","res","downLoadFile","file","_id","responseType","then","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","console","log","getFile","type","params","name","initialState","message","mess","isLoading","reducers","setMessage","state","action","payload","extraReducers","builder","addCase","pending","fulfilled","actions","reducer"],"mappings":"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","sourcesContent":["import {createAsyncThunk, createSlice } from '@reduxjs/toolkit';\r\nimport sendReq from '../helper/sendReqToServer';\r\nimport fileDownload from \"js-file-download\";\r\n\r\nexport const upLoadFile = createAsyncThunk(\r\n    \"localhost:4000/upload\",\r\n    async (data, thunkAPI) => {\r\n        const configReq = {\r\n            method: 'post',\r\n            url: '/upload',\r\n            header: {},\r\n            data: data\r\n        }\r\n        const res = await sendReq(configReq);\r\n        return res.data;\r\n    }\r\n)\r\n\r\nexport const downLoadFile = createAsyncThunk(\r\n    \"localhost:4000/download\",\r\n    async (file, thunkAPI) => {\r\n        const configReq = {\r\n            method: \"get\",\r\n            url: `/file/download/${file._id}`,\r\n            responseType: 'blob',\r\n        }\r\n        await sendReq(configReq)\r\n        .then(async (res) => {\r\n\r\n            const url = window.URL.createObjectURL(new Blob([res.data]));\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', 'file.pdf'); //or any other extension\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            console.log(res)\r\n            //await fileDownload(res.data, file.metadata.originalname);\r\n        });\r\n        //return await fileDownload(res.data, file.metadata.originalname);\r\n    }\r\n)\r\n\r\nexport const getFile = createAsyncThunk(\r\n    \"localhost:4000/file\",\r\n    async (type,thunkAPI) => {\r\n        const configReq = {\r\n            method: \"get\",\r\n            url: '/file',\r\n            params: {\r\n                type : type\r\n            }\r\n        }\r\n        const res = await sendReq(configReq);\r\n        return res.data\r\n    }\r\n)\r\n\r\nconst file = createSlice({\r\n    name: \"file\",\r\n    initialState: {\r\n        file: [\"\"],\r\n        fileDownload: \"\",\r\n        message: {\r\n            type: null,\r\n            mess: null\r\n        },\r\n        isLoading: true\r\n    },\r\n    reducers: {\r\n        setMessage : (state, action) => {\r\n            state.message = action.payload\r\n        }\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder.addCase(upLoadFile.pending, (state, action) => {\r\n            state.isLoading = true;\r\n        })\r\n        builder.addCase(upLoadFile.fulfilled, (state, action) => {\r\n            state.message = action.payload.message\r\n            state.isLoading = false;\r\n        })\r\n        builder.addCase(downLoadFile.fulfilled, (state, action) => {\r\n            state.fileDownload = action.payload;\r\n        })\r\n        builder.addCase(getFile.pending, (state, action) => {\r\n            state.isLoading = true\r\n        })\r\n        builder.addCase(getFile.fulfilled, (state, action) => {\r\n            state.file = action.payload.file\r\n            state.isLoading = false\r\n        })\r\n    }\r\n})\r\n\r\nexport const {setMessage} = file.actions;\r\nexport default file.reducer;"]},"metadata":{},"sourceType":"module"}